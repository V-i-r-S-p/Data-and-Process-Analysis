# Handwriting Recognition: Math Expressions

Этот проект представляет собой нейросетевую модель CRNN, обученную распознавать изображения с рукописными математическими выражениями и переводить их в LaTeX-подобные строки

## Установка

1. Клонируй репозиторий и создай виртуальное окружение:

   ```bash
   python3 -m venv venv_DOP
   source venv_DOP/bin/activate
   ```

2. Установи зависимости:

   ```bash
   pip install -r requirements.txt
   ```

## Подготовка данных

* Положи изображения в папку `data/images/`
* Для каждого изображения должен быть текстовый файл с тем же именем (например, `img1.png` — `img1.txt`) в папке `data/labels/`
* Каждый `.txt` файл должен содержать строку с LaTeX-подобной записью выражения, например:

  ```
  \frac{a+b}{c}
  ```

## Обучение

Для обучения модели:

```bash
python3 model/train.py
```

* Модель сохранится после каждой эпохи в `model/model_epoch№.pth`

## Тестирование

1. Положи изображения, которые нужно распознать, в папку `test_images/`

2. Убедись, что путь к модели в `predict.py` указан верно:

   ```python
   model.load_state_dict(torch.load("model_epoch20.pth", map_location=device))
   ```

3. Запусти:

   ```bash
   python3 model/predict.py
   ```

   Вывод:

   ```
   test_image1.png: \frac{a}{b}
   test_image2.png: x^2 + y^2 = z^2
   ```

## Возможные проблемы

* `<UNK>` в предсказании означает, что символ не распознан или отсутствует в `VOCAB`
* Убедись, что изображения в тесте имеют такой же формат и предобработку, как при обучении (`Grayscale`, `Resize(64, 256)` и т.д.)